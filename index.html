<!DOCTYPE html>
<html>
  <head>
    <!--Import Google Icon Font-->
    <link href="http://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
    <!--Import materialize.css-->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/materialize/0.97.5/css/materialize.min.css">
    <title>Decoder #4521 by felipemfp</title>
    <!--Let browser know website is optimized for mobile-->
    <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  </head>

  <body>
    <div class="container">
    <h1>Decoder #4521</h1>
    <div class="row">
      <div class="input-field col s12">
        <input type="text" length="3" id="key" placeholder="Key" />
        <label for="key">Key</label>
      </div>
      <div class="input-field col s12">
        <textarea id="content"class="materialize-textarea" placeholder="Content"></textarea>
        <label for="content">Content</label>
      </div>
      <div class="col s6">
        <p>
          <input type="checkbox" id="reverse" />
          <label for="reverse">Reverse</label>
        </p>
      </div>
      <div class="col s6">
        <button id="do" class="right waves-effect waves-light btn">Do</button>
      </div>
    </div>
      </div>
    <!--Import jQuery before materialize.js-->
    <script type="text/javascript" src="https://code.jquery.com/jquery-2.1.1.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/materialize/0.97.5/js/materialize.min.js"></script>
    <script>
      $(function() {
      	var _control = "abcdefghiklmnopqrstuvwxyz1234567890";
        
        $('#do').click(function(){
        	var content = '';
          
        	var _key = $('#key').val().toLowerCase();
          var _content = $('#content').val().toLowerCase();
          
          var _one = _key[0],
          		_two = _key.slice(-1);
              
          var _s = _control.indexOf(_two) - _control.indexOf(_one);
         
         	for (var x = 0, length = _content.length; x < length; x++) {
         	  
            if (_content[x] == ' ') {
         	    content = content + ' ';
         	    continue;
         	 	}
          	var _i = _control.indexOf(_content[x]);
            var i = _i;
            if ($('#reverse').is(':checked')) {
              i = _i - _s;
            }
            else {
              i = _i + _s;
            }
            
            if ( i >= _control.length ) {
            	i = i - _control.length;
            } else if ( i < 0 ) {
            	i = i + _control.length;
            }
            
            alert(_i, _s, i, $('#reverse').is(':checked'));
            
          	content = content + _control[i];
          }
          
          $('#content').val(content);
        
        });
        
      });
    </script>
  </body>
</html>
